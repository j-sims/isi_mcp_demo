---
- name: Create snapshot schedule on PowerScale
  hosts: localhost
  connection: local
  gather_facts: false
  collections:
    - dellemc.powerscale

  tasks:
    - name: Create snapshot schedule "{{ name }}"
      dellemc.powerscale.snapshotschedule:
        onefs_host: "{{ onefs_host }}"
        port_no: "{{ port_no }}"
        verify_ssl: {{ verify_ssl }}
        api_user: "{{ api_user }}"
        api_password: "{{ api_password }}"
        name: "{{ name }}"
        path: "{{ path }}"
        pattern: "{{ pattern }}"
        schedule: "{{ schedule }}"
{% if desired_retention is defined and desired_retention %}
        desired_retention: {{ desired_retention }}
        retention_unit: "{{ retention_unit | default('days') }}"
{% endif %}
{% if alias is defined and alias %}
        alias: "{{ alias }}"
{% endif %}
        state: present
